var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,l=(e,s)=>{for(var t in s||(s={}))r.call(s,t)&&n(e,t,s[t]);if(a)for(var t of a(s))i.call(s,t)&&n(e,t,s[t]);return e},d=(e,a)=>s(e,t(a)),o=(e,s,t)=>new Promise((a,r)=>{var i=e=>{try{l(t.next(e))}catch(s){r(s)}},n=e=>{try{l(t.throw(e))}catch(s){r(s)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);l((t=t.apply(e,s)).next())});import{r as c,j as m}from"./ui-BA0cATE-.js";import{C as u,a as h,b as x,B as j,c as p}from"./button-DKtl-THQ.js";import{L as g,I as y}from"./label-BgLNCOK5.js";import{D as f,a as v,b as N,c as b,d as S,T as w}from"./dialog-YMOs-iro.js";import{B as T}from"./badge-DQ5FJ1CI.js";import{u as O,s as P,t as C}from"./index-JY87KjIa.js";import{P as I,n as k,e as D,l as E,Y as F,V as _}from"./icons-DpmH63Q2.js";import"./vendor-Z2Iecplj.js";import"./utils-Dyq5Ev4R.js";const A=()=>{const{currentUser:e}=O(),[s,t]=c.useState([]),[a,r]=c.useState(!1),[i,n]=c.useState(!0),[A,J]=c.useState(!1),[$,L]=c.useState({subject:"",date:(new Date).toISOString().split("T")[0],startTime:"",duration:"",notes:""});c.useEffect(()=>{o(null,null,function*(){try{const s=yield fetch("https://sentience.onrender.com/api/health");if(J(s.ok),s.ok&&e){const e=yield P.getAll();t(e)}else{const e=JSON.parse(localStorage.getItem("studySessions")||"[]");t(e)}}catch(s){console.error("Error loading study sessions:",s);const e=JSON.parse(localStorage.getItem("studySessions")||"[]");t(e)}finally{n(!1)}})},[e]);const z=e=>{if(e<60)return`${e}m`;const s=Math.floor(e/60),t=e%60;return t>0?`${s}h ${t}m`:`${s}h`};return i?m.jsx("div",{className:"page-container",children:m.jsx("div",{className:"flex items-center justify-center h-64",children:m.jsx("div",{className:"text-muted-foreground",children:"Loading study sessions..."})})}):m.jsxs("div",{className:"page-container",children:[m.jsxs("header",{className:"mb-8 animate-slide-in",children:[m.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Study Planner"}),m.jsx("p",{className:"text-muted-foreground mt-1",children:"Track your study sessions and monitor your learning progress"})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[m.jsx(u,{children:m.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx(x,{className:"text-sm font-medium",children:"Total Sessions"}),m.jsx(T,{variant:"secondary",children:s.length})]})}),m.jsx(u,{children:m.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx(x,{className:"text-sm font-medium",children:"Total Study Time"}),m.jsx(T,{variant:"outline",children:z(s.reduce((e,s)=>e+s.duration,0))})]})}),m.jsx(u,{children:m.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx(x,{className:"text-sm font-medium",children:"Today's Study Time"}),m.jsx(T,{variant:"outline",children:z((()=>{const e=(new Date).toISOString().split("T")[0];return s.filter(s=>s.date===e).reduce((e,s)=>e+s.duration,0)})())})]})}),m.jsx(u,{children:m.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx(x,{className:"text-sm font-medium",children:"Subjects"}),m.jsx(T,{variant:"outline",children:Object.keys((()=>{const e={};return s.forEach(s=>{e[s.subject]=(e[s.subject]||0)+s.duration}),e})()).length})]})})]}),m.jsx("div",{className:"mb-6",children:m.jsxs(f,{open:a,onOpenChange:r,children:[m.jsx(v,{asChild:!0,children:m.jsxs(j,{className:"w-full sm:w-auto",children:[m.jsx(I,{className:"mr-2 h-4 w-4"}),"Add Study Session"]})}),m.jsxs(N,{className:"sm:max-w-[425px]",children:[m.jsx(b,{children:m.jsx(S,{children:"Add Study Session"})}),m.jsxs("div",{className:"grid gap-4 py-4",children:[m.jsxs("div",{className:"grid gap-2",children:[m.jsx(g,{htmlFor:"subject",children:"Subject *"}),m.jsx(y,{id:"subject",value:$.subject,onChange:e=>L(d(l({},$),{subject:e.target.value})),placeholder:"e.g., Mathematics, Physics"})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{className:"grid gap-2",children:[m.jsx(g,{htmlFor:"date",children:"Date"}),m.jsx(y,{id:"date",type:"date",value:$.date,onChange:e=>L(d(l({},$),{date:e.target.value}))})]}),m.jsxs("div",{className:"grid gap-2",children:[m.jsx(g,{htmlFor:"startTime",children:"Start Time *"}),m.jsx(y,{id:"startTime",type:"time",value:$.startTime,onChange:e=>L(d(l({},$),{startTime:e.target.value}))})]})]}),m.jsxs("div",{className:"grid gap-2",children:[m.jsx(g,{htmlFor:"duration",children:"Duration (minutes) *"}),m.jsx(y,{id:"duration",type:"number",value:$.duration,onChange:e=>L(d(l({},$),{duration:e.target.value})),placeholder:"60"})]}),m.jsxs("div",{className:"grid gap-2",children:[m.jsx(g,{htmlFor:"notes",children:"Notes (optional)"}),m.jsx(w,{id:"notes",value:$.notes,onChange:e=>L(d(l({},$),{notes:e.target.value})),placeholder:"What did you study? Any important points?"})]})]}),m.jsxs("div",{className:"flex justify-end space-x-2",children:[m.jsx(j,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),m.jsx(j,{onClick:()=>o(null,null,function*(){if($.subject.trim()&&$.startTime&&$.duration)try{const a={subject:$.subject,date:$.date,startTime:$.startTime,duration:parseInt($.duration),notes:$.notes};if(A&&e){const e=yield P.create(a);t([e,...s])}else{const e=[d(l({_id:Date.now().toString()},a),{date:new Date($.date).toISOString()}),...s];t(e),localStorage.setItem("studySessions",JSON.stringify(e))}C({title:"Session added!",description:"Study session has been saved successfully."}),L({subject:"",date:(new Date).toISOString().split("T")[0],startTime:"",duration:"",notes:""}),r(!1)}catch(a){console.error("Error creating study session:",a),C({title:"Error",description:"Failed to save study session. Please try again.",variant:"destructive"})}else C({title:"Error",description:"Please fill in all required fields.",variant:"destructive"})}),children:"Add Session"})]})]})]})}),m.jsx("div",{className:"space-y-4",children:0===s.length?m.jsx(u,{children:m.jsx(p,{className:"flex flex-col items-center justify-center py-12",children:m.jsxs("div",{className:"text-muted-foreground text-center",children:[m.jsx("p",{className:"text-lg font-medium mb-2",children:"No study sessions yet"}),m.jsx("p",{className:"text-sm",children:"Start tracking your study sessions to monitor your progress!"})]})})}):s.map(a=>{return m.jsx(u,{className:"hover:shadow-lg transition-all duration-200",children:m.jsx(p,{className:"p-6",children:m.jsxs("div",{className:"flex items-start justify-between",children:[m.jsxs("div",{className:"flex-1",children:[m.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[m.jsx(k,{className:"h-5 w-5 text-primary"}),m.jsx("h3",{className:"font-semibold text-lg",children:a.subject}),m.jsx(T,{variant:"outline",children:z(a.duration)})]}),m.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mb-3",children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(D,{className:"h-4 w-4"}),m.jsx("span",{children:(r=a.date,new Date(r).toLocaleDateString())})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(E,{className:"h-4 w-4"}),m.jsx("span",{children:a.startTime})]})]}),a.notes&&m.jsx("p",{className:"text-sm text-muted-foreground",children:a.notes})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs(j,{variant:"outline",size:"sm",onClick:()=>{return r=a._id,i={duration:a.duration+30},o(null,null,function*(){try{if(A&&e){const e=yield P.update(r,i);t(s.map(s=>s._id===r?e:s))}else{const e=s.map(e=>e._id===r?l(l({},e),i):e);t(e),localStorage.setItem("studySessions",JSON.stringify(e))}C({title:"Session updated!",description:"Study session has been updated successfully."})}catch(a){console.error("Error updating study session:",a),C({title:"Error",description:"Failed to update study session. Please try again.",variant:"destructive"})}});var r,i},className:"hover:bg-primary/10 hover:border-primary/30",children:[m.jsx(F,{className:"h-4 w-4 mr-1"}),"+30m"]}),m.jsx(j,{variant:"outline",size:"sm",onClick:()=>{return r=a._id,o(null,null,function*(){try{if(A&&e)yield P.delete(r),t(s.filter(e=>e._id!==r));else{const e=s.filter(e=>e._id!==r);t(e),localStorage.setItem("studySessions",JSON.stringify(e))}C({title:"Session deleted",description:"Study session has been removed."})}catch(a){console.error("Error deleting study session:",a),C({title:"Error",description:"Failed to delete study session. Please try again.",variant:"destructive"})}});var r},className:"hover:bg-destructive/10 hover:border-destructive/30 hover:text-destructive",children:m.jsx(_,{className:"h-4 w-4"})})]})]})})},a._id);var r})})]})};export{A as default};
