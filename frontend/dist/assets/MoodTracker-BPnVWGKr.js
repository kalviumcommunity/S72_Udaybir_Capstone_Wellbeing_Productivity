var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(s,t,r)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,o=(e,s)=>{for(var t in s||(s={}))a.call(s,t)&&l(e,t,s[t]);if(r)for(var t of r(s))n.call(s,t)&&l(e,t,s[t]);return e},d=(e,r)=>s(e,t(r)),i=(e,s,t)=>new Promise((r,a)=>{var n=e=>{try{o(t.next(e))}catch(s){a(s)}},l=e=>{try{o(t.throw(e))}catch(s){a(s)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,l);o((t=t.apply(e,s)).next())});import{r as c,j as m}from"./ui-BA0cATE-.js";import{B as x,C as h,a as j,b as u,c as g}from"./button-BDpojYwj.js";import{L as y,I as p}from"./label-C6m5vf69.js";import{D as f,b as v,c as b,d as N,T as w}from"./dialog-D8s8HapV.js";import{B as k}from"./badge-Cy-GHWkU.js";import{T as S,a as D,b as T,c as E,P as M}from"./progress-ByTjJcZV.js";import{u as C,m as O,t as I}from"./index-gkp8X_0E.js";import{P,g as A,k as F,a6 as K,V as L,a7 as U,v as W,m as B,a8 as G,a9 as J,aa as R,ab as _}from"./icons-DpmH63Q2.js";import{R as Y,P as $,a as z,C as V,T as H,L as X,b as q,X as Q,Y as Z,c as ee,B as se,d as te}from"./charts-CqDaeyS0.js";import"./vendor-Z2Iecplj.js";import"./utils-Dyq5Ev4R.js";const re=()=>{const{currentUser:e}=C(),[s,t]=c.useState([]),[r,a]=c.useState(!1),[n,l]=c.useState(!0),[re,ae]=c.useState(!1),[ne,le]=c.useState("tracker"),[oe,de]=c.useState({mood:"neutral",note:"",date:(new Date).toISOString().split("T")[0]});c.useEffect(()=>{i(null,null,function*(){try{const s=yield fetch("https://sentience.onrender.com/api/health");if(ae(s.ok),s.ok&&e){const e=yield O.getAll();t(e)}else{const e=JSON.parse(localStorage.getItem("moodEntries")||"[]");t(e)}}catch(s){console.error("Error loading mood entries:",s);const e=JSON.parse(localStorage.getItem("moodEntries")||"[]");t(e)}finally{l(!1)}})},[e]);const ie=e=>{switch(e){case"excellent":return m.jsx(B,{className:"h-5 w-5 text-yellow-500"});case"good":return m.jsx(R,{className:"h-5 w-5 text-green-500"});case"neutral":return m.jsx(G,{className:"h-5 w-5 text-yellow-500"});case"bad":return m.jsx(J,{className:"h-5 w-5 text-orange-500"});case"terrible":return m.jsx(J,{className:"h-5 w-5 text-red-500"});default:return m.jsx(G,{className:"h-5 w-5"})}},ce=e=>{switch(e){case"excellent":case"neutral":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"good":return"bg-green-100 text-green-800 border-green-200";case"bad":return"bg-orange-100 text-orange-800 border-orange-200";case"terrible":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},me=e=>{switch(e){case"excellent":return"Excellent";case"good":return"Good";case"neutral":return"Neutral";case"bad":return"Bad";case"terrible":return"Terrible";default:return"Unknown"}},xe=(()=>{const e=(()=>{if(0===s.length)return 0;const e={terrible:1,bad:2,neutral:3,good:4,excellent:5};return s.reduce((s,t)=>s+e[t.mood],0)/s.length})(),t=s.slice(0,7),r=s.slice(7,14),a=t.length>0?t.reduce((e,s)=>e+{terrible:1,bad:2,neutral:3,good:4,excellent:5}[s.mood],0)/t.length:0,n=r.length>0?r.reduce((e,s)=>e+{terrible:1,bad:2,neutral:3,good:4,excellent:5}[s.mood],0)/r.length:0;let l="stable";a>n+.5?l="improving":a<n-.5&&(l="declining");const o=s.reduce((e,s)=>(e[s.mood]=(e[s.mood]||0)+1,e),{}),d=Object.entries(o).reduce((e,s)=>o[e[0]]>o[s[0]]?e:s)[0];let i=0;const c=new Date;for(let u=0;u<30;u++){const e=new Date(c);e.setDate(e.getDate()-u);const t=e.toISOString().split("T")[0];if(!s.some(e=>e.date.startsWith(t)))break;i++}const m=s.reduce((e,s)=>{const t=new Date(s.date).getDay();return e[t]=(e[t]||0)+1,e},{}),x=Object.entries(m).reduce((e,s)=>m[parseInt(e[0])]>m[parseInt(s[0])]?e:s),h=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][parseInt(x[0])],j=[];return e<3&&j.push("Consider activities that boost your mood"),i<3&&j.push("Try to track your mood more regularly"),"declining"===l&&j.push("Focus on self-care and positive activities"),0===j.length&&j.push("Keep up the great work!"),{averageMood:e,moodTrend:l,mostCommonMood:d.charAt(0).toUpperCase()+d.slice(1),totalEntries:s.length,streakDays:i,weeklyPattern:h,recommendations:j}})(),he=(()=>{const e={terrible:1,bad:2,neutral:3,good:4,excellent:5};return Array.from({length:7},(e,s)=>{const t=new Date;return t.setDate(t.getDate()-s),t.toISOString().split("T")[0]}).reverse().map(t=>{const r=s.filter(e=>e.date.startsWith(t)),a=r.length>0?r.reduce((s,t)=>s+e[t.mood],0)/r.length:0;return{day:new Date(t).toLocaleDateString("en-US",{weekday:"short"}),score:a,entries:r.length}})})(),je=[{name:"Excellent",value:s.filter(e=>"excellent"===e.mood).length,color:"#10b981"},{name:"Good",value:s.filter(e=>"good"===e.mood).length,color:"#3b82f6"},{name:"Neutral",value:s.filter(e=>"neutral"===e.mood).length,color:"#f59e0b"},{name:"Bad",value:s.filter(e=>"bad"===e.mood).length,color:"#ef4444"},{name:"Terrible",value:s.filter(e=>"terrible"===e.mood).length,color:"#7c3aed"}];return n?m.jsx("div",{className:"page-container",children:m.jsx("div",{className:"flex items-center justify-center h-64",children:m.jsx("div",{className:"text-muted-foreground",children:"Loading mood tracker..."})})}):m.jsxs("div",{className:"page-container",children:[m.jsx("header",{className:"mb-8 animate-slide-in",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Mood Tracker"}),m.jsx("p",{className:"text-muted-foreground mt-1",children:"Track your emotional well-being and discover patterns"})]}),m.jsxs(x,{onClick:()=>a(!0),className:"flex items-center gap-2",children:[m.jsx(P,{className:"h-4 w-4"}),"Add Entry"]})]})}),m.jsxs(S,{value:ne,onValueChange:le,className:"space-y-6",children:[m.jsxs(D,{className:"grid w-full grid-cols-3",children:[m.jsx(T,{value:"tracker",children:"Mood Tracker"}),m.jsx(T,{value:"insights",children:"Insights"}),m.jsx(T,{value:"analytics",children:"Analytics"})]}),m.jsxs(E,{value:"tracker",className:"space-y-6",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[m.jsxs(h,{children:[m.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx(u,{className:"text-sm font-medium",children:"Average Mood"}),m.jsx(A,{className:"h-4 w-4 text-muted-foreground"})]}),m.jsxs(g,{children:[m.jsxs("div",{className:"text-2xl font-bold",children:[xe.averageMood.toFixed(1),"/5"]}),m.jsx(M,{value:xe.averageMood/5*100,className:"mt-2"}),m.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:xe.averageMood>=4?"Great mood!":xe.averageMood>=3?"Good mood":"Could be better"})]})]}),m.jsxs(h,{children:[m.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx(u,{className:"text-sm font-medium",children:"Current Streak"}),m.jsx(F,{className:"h-4 w-4 text-muted-foreground"})]}),m.jsxs(g,{children:[m.jsxs("div",{className:"text-2xl font-bold",children:[xe.streakDays," days"]}),m.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:xe.streakDays>=7?"Amazing consistency!":"Keep it up!"})]})]}),m.jsxs(h,{children:[m.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx(u,{className:"text-sm font-medium",children:"Total Entries"}),m.jsx(K,{className:"h-4 w-4 text-muted-foreground"})]}),m.jsxs(g,{children:[m.jsx("div",{className:"text-2xl font-bold",children:xe.totalEntries}),m.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:xe.totalEntries>=30?"Great tracking!":"More entries = better insights"})]})]}),m.jsxs(h,{children:[m.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx(u,{className:"text-sm font-medium",children:"Mood Trend"}),"improving"===xe.moodTrend?m.jsx(_,{className:"h-4 w-4 text-green-500"}):"declining"===xe.moodTrend?m.jsx(_,{className:"h-4 w-4 text-red-500 rotate-180"}):m.jsx(K,{className:"h-4 w-4 text-blue-500"})]}),m.jsxs(g,{children:[m.jsx("div",{className:"text-2xl font-bold "+("improving"===xe.moodTrend?"text-green-600":"declining"===xe.moodTrend?"text-red-600":"text-blue-600"),children:xe.moodTrend.charAt(0).toUpperCase()+xe.moodTrend.slice(1)}),m.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Compared to previous week"})]})]})]}),m.jsxs(h,{children:[m.jsx(j,{children:m.jsx(u,{children:"Recent Mood Entries"})}),m.jsx(g,{children:0===s.length?m.jsxs("div",{className:"text-center py-8",children:[m.jsx(A,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),m.jsx("h3",{className:"text-lg font-medium mb-2",children:"No mood entries yet"}),m.jsx("p",{className:"text-muted-foreground mb-4",children:"Start tracking your mood to see patterns and insights"}),m.jsx(x,{onClick:()=>a(!0),children:"Add Your First Entry"})]}):m.jsx("div",{className:"space-y-4",children:s.slice(0,10).map(r=>{return m.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[ie(r.mood),m.jsxs("div",{children:[m.jsx("div",{className:"font-medium",children:me(r.mood)}),m.jsx("div",{className:"text-sm text-muted-foreground",children:(a=r.date,new Date(a).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}))}),r.note&&m.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:['"',r.note,'"']})]})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(k,{variant:"outline",className:ce(r.mood),children:me(r.mood)}),m.jsx(x,{variant:"ghost",size:"sm",onClick:()=>{return a=r._id,i(null,null,function*(){try{re&&e&&(yield O.delete(a));const r=s.filter(e=>e._id!==a);t(r),localStorage.setItem("moodEntries",JSON.stringify(r)),I({title:"Entry deleted",description:"Mood entry has been removed."})}catch(r){console.error("Error deleting mood entry:",r),I({title:"Failed to delete entry",description:"Please try again.",variant:"destructive"})}});var a},className:"text-red-500 hover:text-red-700",children:m.jsx(L,{className:"h-4 w-4"})})]})]},r._id);var a})})})]})]}),m.jsxs(E,{value:"insights",className:"space-y-6",children:[m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[m.jsxs(h,{children:[m.jsx(j,{children:m.jsxs(u,{className:"flex items-center gap-2",children:[m.jsx(U,{className:"h-5 w-5"}),"Mood Insights"]})}),m.jsx(g,{children:m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm",children:"Most Common Mood"}),m.jsx(k,{variant:"secondary",children:xe.mostCommonMood})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm",children:"Most Active Day"}),m.jsx(k,{variant:"secondary",children:xe.weeklyPattern})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm",children:"Current Streak"}),m.jsxs(k,{variant:"secondary",children:[xe.streakDays," days"]})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm",children:"Total Entries"}),m.jsx(k,{variant:"secondary",children:xe.totalEntries})]})]})})]}),m.jsxs(h,{children:[m.jsx(j,{children:m.jsxs(u,{className:"flex items-center gap-2",children:[m.jsx(W,{className:"h-5 w-5"}),"Recommendations"]})}),m.jsx(g,{children:m.jsx("div",{className:"space-y-3",children:xe.recommendations.map((e,s)=>m.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg",children:[m.jsx(B,{className:"h-4 w-4 text-blue-500 mt-0.5"}),m.jsx("span",{className:"text-sm",children:e})]},s))})})]})]}),m.jsxs(h,{children:[m.jsx(j,{children:m.jsx(u,{children:"Mood Distribution"})}),m.jsx(g,{children:m.jsx(Y,{width:"100%",height:300,children:m.jsxs($,{children:[m.jsx(z,{data:je,cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",children:je.map((e,s)=>m.jsx(V,{fill:e.color},`cell-${s}`))}),m.jsx(H,{})]})})})]})]}),m.jsxs(E,{value:"analytics",className:"space-y-6",children:[m.jsxs(h,{children:[m.jsx(j,{children:m.jsx(u,{children:"Mood Trends (Last 7 Days)"})}),m.jsx(g,{children:m.jsx(Y,{width:"100%",height:300,children:m.jsxs(X,{data:he,children:[m.jsx(q,{strokeDasharray:"3 3"}),m.jsx(Q,{dataKey:"day"}),m.jsx(Z,{domain:[0,5]}),m.jsx(H,{formatter:e=>[0===e?"No entries":`${e.toFixed(1)}/5`,"Mood Score"],labelFormatter:e=>`Day: ${e}`}),m.jsx(ee,{type:"monotone",dataKey:"score",stroke:"#8884d8",strokeWidth:2})]})})})]}),m.jsxs(h,{children:[m.jsx(j,{children:m.jsx(u,{children:"Weekly Activity"})}),m.jsx(g,{children:m.jsx(Y,{width:"100%",height:300,children:m.jsxs(se,{data:he,children:[m.jsx(q,{strokeDasharray:"3 3"}),m.jsx(Q,{dataKey:"day"}),m.jsx(Z,{}),m.jsx(H,{formatter:e=>[e,"Entries"]}),m.jsx(te,{dataKey:"entries",fill:"#82ca9d"})]})})})]})]})]}),m.jsx(f,{open:r,onOpenChange:a,children:m.jsxs(v,{className:"sm:max-w-md",children:[m.jsx(b,{children:m.jsx(N,{children:"Add Mood Entry"})}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx(y,{htmlFor:"date",children:"Date"}),m.jsx(p,{id:"date",type:"date",value:oe.date,onChange:e=>de(d(o({},oe),{date:e.target.value})),max:(new Date).toISOString().split("T")[0]})]}),m.jsxs("div",{children:[m.jsx(y,{children:"How are you feeling?"}),m.jsx("div",{className:"grid grid-cols-5 gap-2 mt-2",children:["terrible","bad","neutral","good","excellent"].map(e=>m.jsxs(x,{variant:oe.mood===e?"default":"outline",className:"flex flex-col items-center gap-1 h-auto py-3",onClick:()=>de(d(o({},oe),{mood:e})),children:[ie(e),m.jsx("span",{className:"text-xs",children:me(e)})]},e))})]}),m.jsxs("div",{children:[m.jsx(y,{htmlFor:"note",children:"Notes (optional)"}),m.jsx(w,{id:"note",placeholder:"What's on your mind?",value:oe.note,onChange:e=>de(d(o({},oe),{note:e.target.value})),rows:3})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx(x,{onClick:()=>i(null,null,function*(){try{const r={mood:oe.mood,note:oe.note,date:oe.date};if(re&&e){const e=yield O.create(r);t([e,...s])}else{const e=[d(o({_id:Date.now().toString()},r),{date:new Date(oe.date).toISOString()}),...s];t(e),localStorage.setItem("moodEntries",JSON.stringify(e))}I({title:"Mood recorded!",description:"Your mood has been saved successfully."}),de({mood:"neutral",note:"",date:(new Date).toISOString().split("T")[0]}),a(!1)}catch(r){console.error("Error adding mood entry:",r),I({title:"Failed to record mood",description:"Please try again.",variant:"destructive"})}}),className:"flex-1",children:"Save Entry"}),m.jsx(x,{variant:"outline",onClick:()=>a(!1),children:"Cancel"})]})]})]})})]})};export{re as default};
