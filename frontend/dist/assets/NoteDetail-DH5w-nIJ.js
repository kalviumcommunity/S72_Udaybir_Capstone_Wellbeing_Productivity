var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,i=(e,s)=>{for(var t in s||(s={}))r.call(s,t)&&n(e,t,s[t]);if(a)for(var t of a(s))l.call(s,t)&&n(e,t,s[t]);return e},d=(e,a)=>s(e,t(a));import{r as o,j as c}from"./ui-BA0cATE-.js";import{b as m,u as x,a as h,L as u,c as g}from"./index-JY87KjIa.js";import{o as p,z as j,I as f,J as b,D as N,U as v,W as w,n as y}from"./icons-DpmH63Q2.js";import"./vendor-Z2Iecplj.js";import"./utils-Dyq5Ev4R.js";const S=[],k={},O=()=>{const{noteId:e}=m(),{currentUser:s}=x(),t=h(),[a,r]=o.useState(null),[l,n]=o.useState([]),[O,A]=o.useState(""),[I,D]=o.useState(!1);if(o.useEffect(()=>{var a;if(!e)return;const l=JSON.parse(localStorage.getItem("global_notes")||"[]").find(s=>s.id===e);if(l){const t=d(i({},l),{createdAt:new Date(l.createdAt),updatedAt:new Date(l.updatedAt)});r(t);const o=JSON.parse(localStorage.getItem("note_comments")||"[]").filter(s=>s.noteId===e).map(e=>({id:e.id,text:e.content,author:e.author,createdAt:new Date(e.createdAt)}));n(o),s&&(null==(a=t.likedBy)?void 0:a.includes(s.id))&&D(!0)}else{const s=S.find(s=>s.id===e);s?(r(s),n(k[e]||[])):t("/notes")}},[e,t,s]),!a)return c.jsx("div",{className:"page-container",children:c.jsx("div",{className:"flex justify-center items-center h-64",children:c.jsx("div",{className:"animate-pulse",children:"Loading..."})})});const J=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return c.jsxs("div",{className:"page-container",children:[c.jsx("div",{className:"flex items-center mb-6",children:c.jsxs(u,{to:"/notes",className:"flex items-center text-muted-foreground hover:text-foreground",children:[c.jsx(p,{className:"h-4 w-4 mr-2"}),"Back to Notes"]})}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[c.jsxs("div",{className:"lg:col-span-2",children:[c.jsxs("div",{className:"hub-card p-6 animate-fade-in",children:[c.jsxs("div",{className:"border-b border-border pb-4 mb-6",children:[c.jsx("h1",{className:"text-2xl font-bold mb-2",children:a.title}),c.jsx("p",{className:"text-muted-foreground",children:a.description}),c.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[c.jsx("span",{className:"hub-tag bg-primary/10 text-primary",children:a.category}),a.tags.map((e,s)=>c.jsx("span",{className:"hub-tag bg-muted text-muted-foreground",children:e},s))]})]}),c.jsx("div",{className:"prose prose-blue max-w-none",children:c.jsx("pre",{className:"whitespace-pre-wrap text-sm",children:a.content})}),c.jsxs("div",{className:"flex flex-wrap gap-4 mt-8 pt-4 border-t border-border",children:[c.jsxs("button",{className:g("flex items-center gap-2 hub-button",I?"bg-primary":"bg-muted text-foreground hover:bg-muted/80"),onClick:()=>{if(!s)return;const e=!I;D(e);const t=d(i({},a),{likes:e?a.likes+1:a.likes-1,likedBy:e?[...a.likedBy||[],s.id]:(a.likedBy||[]).filter(e=>e!==s.id)});r(t);const l=JSON.parse(localStorage.getItem("global_notes")||"[]").map(e=>e.id===a.id?t:e);localStorage.setItem("global_notes",JSON.stringify(l))},children:[c.jsx(j,{className:"h-4 w-4"}),I?"Liked":"Like",c.jsxs("span",{className:"ml-1",children:["(",a.likes,")"]})]}),c.jsxs("button",{className:"flex items-center gap-2 hub-button bg-muted text-foreground hover:bg-muted/80",onClick:()=>{alert("Downloading note..."),r(d(i({},a),{downloads:a.downloads+1}))},children:[c.jsx(f,{className:"h-4 w-4"}),"Download",c.jsxs("span",{className:"ml-1",children:["(",a.downloads,")"]})]}),c.jsxs("button",{className:"flex items-center gap-2 hub-button bg-muted text-foreground hover:bg-muted/80",children:[c.jsx(b,{className:"h-4 w-4"}),"Share"]})]})]}),c.jsxs("div",{className:"hub-card p-6 mt-6 animate-fade-in",children:[c.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[c.jsx(N,{className:"h-5 w-5 mr-2"}),"Comments (",l.length,")"]}),c.jsx("div",{className:"mb-6",children:c.jsxs("div",{className:"flex gap-3",children:[c.jsx("div",{className:"flex-shrink-0",children:s?c.jsx("img",{src:s.avatar,alt:s.name,className:"w-10 h-10 rounded-full"}):c.jsx("div",{className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center",children:c.jsx(v,{className:"h-5 w-5 text-muted-foreground"})})}),c.jsxs("div",{className:"flex-grow",children:[c.jsx("textarea",{className:"hub-input min-h-[100px]",placeholder:s?"Add a comment...":"Sign in to comment...",value:O,onChange:e=>A(e.target.value),disabled:!s}),c.jsx("div",{className:"flex justify-end mt-2",children:c.jsxs("button",{className:"hub-button flex items-center gap-1",onClick:()=>{if(!s||!O.trim())return;const e={id:Date.now().toString(),text:O.trim(),author:{id:s.id,name:s.name,avatar:s.avatar},createdAt:new Date},t=JSON.parse(localStorage.getItem("note_comments")||"[]");t.push(d(i({},e),{noteId:a.id,content:e.text})),localStorage.setItem("note_comments",JSON.stringify(t)),n([...l,e]),A("");const o=d(i({},a),{comments:a.comments+1});r(o);const c=JSON.parse(localStorage.getItem("global_notes")||"[]").map(e=>e.id===a.id?o:e);localStorage.setItem("global_notes",JSON.stringify(c))},disabled:!s||!O.trim(),children:[c.jsx(w,{className:"h-4 w-4"}),"Post Comment"]})})]})]})}),l.length>0?c.jsx("div",{className:"space-y-4",children:l.map(e=>{return c.jsxs("div",{className:"flex gap-3 pb-4 border-b border-border last:border-0",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("img",{src:e.author.avatar,alt:e.author.name,className:"w-10 h-10 rounded-full"})}),c.jsxs("div",{className:"flex-grow",children:[c.jsxs("div",{className:"flex items-baseline justify-between",children:[c.jsx("h4",{className:"font-medium",children:e.author.name}),c.jsxs("span",{className:"text-xs text-muted-foreground",children:[J(e.createdAt)," at ",(s=e.createdAt,new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}))]})]}),c.jsx("p",{className:"mt-1 text-sm",children:e.text})]})]},e.id);var s})}):c.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[c.jsx(N,{className:"h-10 w-10 mx-auto mb-2 opacity-30"}),c.jsx("p",{children:"No comments yet. Be the first to comment!"})]})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"hub-card p-6 animate-fade-in",children:[c.jsx("h2",{className:"text-lg font-semibold mb-4",children:"About the Author"}),c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("img",{src:a.author.avatar,alt:a.author.name,className:"w-12 h-12 rounded-full"}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-medium",children:a.author.name}),c.jsxs("p",{className:"text-sm text-muted-foreground",children:["Published on ",J(a.createdAt)]})]})]}),c.jsx("div",{className:"border-t border-border pt-4 mt-4",children:c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-muted-foreground",children:"Notes:"}),c.jsx("span",{className:"font-medium",children:S.filter(e=>e.author.id===a.author.id).length})]})})]}),c.jsxs("div",{className:"hub-card p-6 mt-6 animate-fade-in",children:[c.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Related Notes"}),c.jsx("div",{className:"space-y-4",children:S.filter(e=>e.id!==a.id&&e.category===a.category).slice(0,3).map(e=>c.jsxs(u,{to:`/notes/${e.id}`,className:"flex gap-3 group",children:[c.jsx(y,{className:"h-5 w-5 text-primary mt-1 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-medium group-hover:text-primary transition-colors",children:e.title}),c.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.description.substring(0,60),"..."]})]})]},e.id))})]})]})]})]})};export{O as default};
